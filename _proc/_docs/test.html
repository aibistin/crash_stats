<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>crash_stats - NYC Collision Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="crash_stats - NYC Collision Data Analysis">
<meta property="og:image" content="https://aibistin.github.io/crash_stats/test_files/figure-html/cell-18-output-1.png">
<meta property="og:site-name" content="crash_stats">
<meta property="og:image:height" content="1511">
<meta property="og:image:width" content="1011">
<meta name="twitter:title" content="crash_stats - NYC Collision Data Analysis">
<meta name="twitter:image" content="https://aibistin.github.io/crash_stats/test_files/figure-html/cell-18-output-1.png">
<meta name="twitter:image-height" content="1511">
<meta name="twitter:image-width" content="1011">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">crash_stats</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">NYC Collision Data Analysis</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">crash_stats</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./crash_time_period_stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NYC Collision Data Analysis</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#focusing-on-casualty-statistics-over-different-time-periods" id="toc-focusing-on-casualty-statistics-over-different-time-periods" class="nav-link active" data-scroll-target="#focusing-on-casualty-statistics-over-different-time-periods">Focusing on casualty statistics over different time periods</a>
  <ul class="collapse">
  <li><a href="#read-the-nyc-collision-data-csv-file." id="toc-read-the-nyc-collision-data-csv-file." class="nav-link" data-scroll-target="#read-the-nyc-collision-data-csv-file.">Read the NYC collision data CSV file.</a></li>
  </ul></li>
  <li><a href="#print-out-the-column-names-before-and-after-they-are-renamed" id="toc-print-out-the-column-names-before-and-after-they-are-renamed" class="nav-link" data-scroll-target="#print-out-the-column-names-before-and-after-they-are-renamed">Print out the column names before and after they are renamed</a>
  <ul class="collapse">
  <li><a href="#merge-the-date-and-time-columns-into-one-date-column." id="toc-merge-the-date-and-time-columns-into-one-date-column." class="nav-link" data-scroll-target="#merge-the-date-and-time-columns-into-one-date-column.">Merge the ‘DATE’ and ‘TIME’ columns into one ‘DATE’ column.</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/aibistin/crash_stats/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">NYC Collision Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="focusing-on-casualty-statistics-over-different-time-periods" class="level2">
<h2 class="anchored" data-anchor-id="focusing-on-casualty-statistics-over-different-time-periods">Focusing on casualty statistics over different time periods</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import All Required Python Modules</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Formatting Functions</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> empty_to_zero(val):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Converts empty values to 0'''</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    val <span class="op">=</span> val.strip(<span class="st">'\s+'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> val <span class="cf">if</span> <span class="bu">len</span>(val) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_numeric(df, column_list):</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''Given a list of DataFrame columns, it converts the empty values to zero'''</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    df[column_list] <span class="op">=</span> df[column_list].<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">'coerce'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up Some Global Variables</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I'm omitting longitude, latitude, the vehicle types as well as crash contributing factors.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>cols_requested <span class="op">=</span> [<span class="st">'COLLISION_ID'</span>, <span class="st">'CRASH DATE'</span>, <span class="st">'CRASH TIME'</span>, <span class="st">'BOROUGH'</span>, <span class="st">'ZIP CODE'</span>, <span class="st">'LOCATION'</span>, <span class="st">'ON STREET NAME'</span>, <span class="st">'CROSS STREET NAME'</span>, <span class="st">'OFF STREET NAME'</span>, <span class="st">'NUMBER OF PERSONS INJURED'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'NUMBER OF PERSONS KILLED'</span>, <span class="st">'NUMBER OF PEDESTRIANS INJURED'</span>, <span class="st">'NUMBER OF PEDESTRIANS KILLED'</span>, <span class="st">'NUMBER OF CYCLIST INJURED'</span>, <span class="st">'NUMBER OF CYCLIST KILLED'</span>, <span class="st">'NUMBER OF MOTORIST INJURED'</span>, <span class="st">'NUMBER OF MOTORIST KILLED'</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To ensure that the colums are of the expected data type</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>crash_dtypes <span class="op">=</span> {<span class="st">'CRASH DATE'</span>: <span class="bu">str</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'CRASH TIME'</span>: <span class="bu">str</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'BOROUGH'</span>: <span class="bu">str</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ZIP CODE'</span>: <span class="bu">str</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'LOCATION'</span>: <span class="bu">str</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'ON STREET NAME'</span>: <span class="bu">str</span>,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">'CROSS STREET NAME'</span>: <span class="bu">str</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'OFF STREET NAME'</span>: <span class="bu">str</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename some colums to ones that I believe are shorter and/or more meaningful</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>cols_rename <span class="op">=</span> {<span class="st">'CRASH DATE'</span>: <span class="st">'DATE'</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>               <span class="st">'CRASH TIME'</span>: <span class="st">'TIME'</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>               <span class="st">'ZIP CODE'</span>: <span class="st">'ZIP_CODE'</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>               <span class="st">'ON STREET NAME'</span>: <span class="st">'ON_STREET_NAME'</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>               <span class="st">'CROSS STREET NAME'</span>: <span class="st">'CROSS_STREET_NAME'</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>               <span class="st">'OFF STREET NAME'</span>: <span class="st">'OFF_STREET_NAME'</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF PERSONS INJURED'</span>: <span class="st">'NUM_PERSONS_INJURED'</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF PERSONS KILLED'</span>: <span class="st">'NUM_PERSONS_KILLED'</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF PEDESTRIANS INJURED'</span>: <span class="st">'NUM_PEDESTRIANS_INJURED'</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF PEDESTRIANS KILLED'</span>: <span class="st">'NUM_PEDESTRIANS_KILLED'</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF CYCLIST INJURED'</span>: <span class="st">'NUM_CYCLISTS_INJURED'</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF CYCLIST KILLED'</span>: <span class="st">'NUM_CYCLISTS_KILLED'</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF MOTORIST INJURED'</span>: <span class="st">'NUM_MOTORISTS_INJURED'</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>               <span class="st">'NUMBER OF MOTORIST KILLED'</span>: <span class="st">'NUM_MOTORISTS_KILLED'</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>               }</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns that contain numeric values</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> [<span class="st">'NUM_PERSONS_INJURED'</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_PERSONS_KILLED'</span>,</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_PEDESTRIANS_INJURED'</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_PEDESTRIANS_KILLED'</span>,</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_CYCLISTS_INJURED'</span>,</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_CYCLISTS_KILLED'</span>,</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_MOTORISTS_INJURED'</span>,</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'NUM_MOTORISTS_KILLED'</span>]</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co"># These ordered lists are useful for plotting charts</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>day_names_order <span class="op">=</span> [<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>]</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>day_abbr_order <span class="op">=</span> [d[<span class="dv">0</span>:<span class="dv">3</span>] <span class="cf">for</span> d <span class="kw">in</span> day_names_order]</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>month_names_order <span class="op">=</span> [<span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>,</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>, <span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>, <span class="st">"December"</span>]</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>month_abbr_order <span class="op">=</span> [m[<span class="dv">0</span>:<span class="dv">3</span>] <span class="cf">for</span> m <span class="kw">in</span> month_names_order]</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># The following DataFrame columns that will have their empty values converted to zero using the</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 'empty_to_zero' function</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>convert_cols <span class="op">=</span> {</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF PERSONS INJURED'</span>: empty_to_zero,</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF PERSONS KILLED'</span>:  empty_to_zero,</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF PEDESTRIANS INJURED'</span>: empty_to_zero,</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF PEDESTRIANS KILLED'</span>: empty_to_zero,</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF CYCLIST INJURED'</span>: empty_to_zero,</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF CYCLIST KILLED'</span>: empty_to_zero,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF MOTORIST INJURED'</span>: empty_to_zero,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NUMBER OF MOTORIST KILLED'</span>: empty_to_zero</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the 4 categories supplied by the NYPD</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="co"># 'person' status should be a combination of the other three categories</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co"> I need to verify the relationship between 'person' and the other three categories</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>victim_categories <span class="op">=</span> [<span class="st">'person'</span>, <span class="st">'cyclist'</span>, <span class="st">'motorist'</span>, <span class="st">'pedestrian'</span>]</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="co"># These are the Matplotlib Tableau colors</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>bar_colors <span class="op">=</span> [<span class="st">'tab:blue'</span>, <span class="st">'tab:orange'</span>, <span class="st">'tab:green'</span>, <span class="st">'tab:red'</span>,</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>              <span class="st">'tab:purple'</span>, <span class="st">'tab:brown'</span>, <span class="st">'tab:pink'</span>, <span class="st">'tab:gray'</span>, <span class="st">'tab:olive'</span>, <span class="st">'tab:cyan'</span>]</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>base_colors <span class="op">=</span> [<span class="st">'b'</span>, <span class="st">'g'</span>, <span class="st">'r'</span>, <span class="st">'c'</span>, <span class="st">'m'</span>, <span class="st">'y'</span>, <span class="st">'k'</span>, <span class="st">'w'</span>]</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Chart Colors</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="st">'k'</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'text.color'</span>] <span class="op">=</span> color</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.labelcolor'</span>] <span class="op">=</span> color</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.color'</span>] <span class="op">=</span> <span class="st">'b'</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.color'</span>] <span class="op">=</span> <span class="st">'b'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="read-the-nyc-collision-data-csv-file." class="level3">
<h3 class="anchored" data-anchor-id="read-the-nyc-collision-data-csv-file.">Read the NYC collision data CSV file.</h3>
<section id="the-collision-dataset-provided-by-nypd-is-available-here." class="level4">
<h4 class="anchored" data-anchor-id="the-collision-dataset-provided-by-nypd-is-available-here.">The Collision Dataset provided by NYPD <a href="https://data.cityofnewyork.us/Public-Safety/Motor-Vehicle-Collisions-Crashes/h9gi-nx95">is available here</a>.</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the Pandas 'read_csv' function</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>crash <span class="op">=</span> pd.read_csv(<span class="st">'../Motor_Vehicle_Collisions_Aug15_2023.csv'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    index_col<span class="op">=</span><span class="st">'COLLISION_ID'</span>, usecols<span class="op">=</span>cols_requested, dtype<span class="op">=</span>crash_dtypes, converters<span class="op">=</span>convert_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="print-out-the-column-names-before-and-after-they-are-renamed" class="level2">
<h2 class="anchored" data-anchor-id="print-out-the-column-names-before-and-after-they-are-renamed">Print out the column names before and after they are renamed</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>original_col_names <span class="op">=</span> crash.columns.to_list()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Crash Column Names"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(original_col_names)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the columns using the list of new names, 'cols_rename'</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>crash.rename(columns<span class="op">=</span>cols_rename, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Renamed Crash Columns Names"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(crash.columns.to_list())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original Crash Column Names
['CRASH DATE', 'CRASH TIME', 'BOROUGH', 'ZIP CODE', 'LOCATION', 'ON STREET NAME', 'CROSS STREET NAME', 'OFF STREET NAME', 'NUMBER OF PERSONS INJURED', 'NUMBER OF PERSONS KILLED', 'NUMBER OF PEDESTRIANS INJURED', 'NUMBER OF PEDESTRIANS KILLED', 'NUMBER OF CYCLIST INJURED', 'NUMBER OF CYCLIST KILLED', 'NUMBER OF MOTORIST INJURED', 'NUMBER OF MOTORIST KILLED']
Renamed Crash Columns Names
['DATE', 'TIME', 'BOROUGH', 'ZIP_CODE', 'LOCATION', 'ON_STREET_NAME', 'CROSS_STREET_NAME', 'OFF_STREET_NAME', 'NUM_PERSONS_INJURED', 'NUM_PERSONS_KILLED', 'NUM_PEDESTRIANS_INJURED', 'NUM_PEDESTRIANS_KILLED', 'NUM_CYCLISTS_INJURED', 'NUM_CYCLISTS_KILLED', 'NUM_MOTORISTS_INJURED', 'NUM_MOTORISTS_KILLED']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure that the 'numeric_cols' column values are numeric and not string values</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>convert_to_numeric(crash, numeric_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  General Description of the dataset.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'set_option' is uesed here to display numeric values as a 'float' rather</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># than the default scientific notation</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.float_format'</span>, <span class="kw">lambda</span> x: <span class="st">'</span><span class="sc">%8.2f</span><span class="st">'</span> <span class="op">%</span> x)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>crash.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_PERSONS_INJURED</th>
<th data-quarto-table-cell-role="th">NUM_PERSONS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_INJURED</th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_CYCLISTS_INJURED</th>
<th data-quarto-table-cell-role="th">NUM_CYCLISTS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_MOTORISTS_INJURED</th>
<th data-quarto-table-cell-role="th">NUM_MOTORISTS_KILLED</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
<td>2017370.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.30</td>
<td>0.00</td>
<td>0.06</td>
<td>0.00</td>
<td>0.03</td>
<td>0.00</td>
<td>0.22</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.69</td>
<td>0.04</td>
<td>0.24</td>
<td>0.03</td>
<td>0.16</td>
<td>0.01</td>
<td>0.65</td>
<td>0.03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>43.00</td>
<td>8.00</td>
<td>27.00</td>
<td>6.00</td>
<td>4.00</td>
<td>2.00</td>
<td>43.00</td>
<td>5.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="merge-the-date-and-time-columns-into-one-date-column." class="level3">
<h3 class="anchored" data-anchor-id="merge-the-date-and-time-columns-into-one-date-column.">Merge the ‘DATE’ and ‘TIME’ columns into one ‘DATE’ column.</h3>
<p>The original ‘DATE’ is a “date only” field without the time. After merging the date and time columns, convert ‘DATE’ to a Python “datetime” object. Then remove the now unnecessary ‘TIME’ column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'DATE'</span>] <span class="op">=</span> pd.to_datetime(crash[<span class="st">'DATE'</span>] <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> crash[<span class="st">'TIME'</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the 'TIME' column</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>crash.drop(columns<span class="op">=</span>[<span class="st">'TIME'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to Python 'datetime'</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'DATE'</span>] <span class="op">=</span> pd.to_datetime(crash[<span class="st">'DATE'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'DATE'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>count                          2017370
mean     2017-05-13 17:54:54.650598912
min                2012-07-01 00:05:00
25%                2014-12-19 13:00:15
50%                2017-03-29 10:07:30
75%                2019-06-09 17:50:00
max                2023-08-12 23:56:00
Name: DATE, dtype: object</code></pre>
</div>
</div>
<section id="from-the-crashdate.describe" class="level4">
<h4 class="anchored" data-anchor-id="from-the-crashdate.describe">From the <code>crash['DATE'].describe()</code></h4>
<p>We can see that the first collision record (<strong>min</strong>) was on July 7, 2012 The last record (<strong>max</strong>), for this iteration is August 12, 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a "start_date" and "end_date" variable, which is useful for our charts</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.date.<span class="bu">min</span>()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.date.<span class="bu">max</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Start Date: </span><span class="sc">{0}</span><span class="st"> - End Date: </span><span class="sc">{1}</span><span class="st">"</span>.<span class="bu">format</span>(start_date, end_date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start Date: 2012-07-01 - End Date: 2023-08-12</code></pre>
</div>
</div>
</section>
<section id="the-unknown-borough" class="level4">
<h4 class="anchored" data-anchor-id="the-unknown-borough">The ‘UNKNOWN’ Borough</h4>
<p>The <strong>BOROUGH</strong> column contains the 5 boroughs of New York City, BROOKLYN, BRONX, MANHATTAN, QUEENS and STATEN ISLAND.<br>
Unfortunately, many of the ‘BOROUGH’ fields are empty.<br>
The NYPD don’t record the borough in certain situations. For example, if the collision occurred on one of the main bridges between boroughs, or if the collision occurred on any one of NYC’s many expressways or parkways. Further investigation would be needed to confirm this.<br>
<em>I previously reached out to the open data team for more information on this, but got no reply</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace empty 'BOROUGH' values with 'UNKNOWN'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>crash.fillna(value<span class="op">=</span>{<span class="st">'BOROUGH'</span>: <span class="st">'UNKNOWN'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'BOROUGH'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>count     2017370
unique          6
top       UNKNOWN
freq       627585
Name: BOROUGH, dtype: object</code></pre>
</div>
</div>
</section>
<section id="crashborough.describe-provides-some-useful-information." class="level4">
<h4 class="anchored" data-anchor-id="crashborough.describe-provides-some-useful-information."><code>crash['BOROUGH'].describe()</code> provides some useful information.</h4>
<ul>
<li><strong>unique</strong>
<ul>
<li>Unique borough name count, which includes the ‘UNKNOWN’ borough</li>
</ul></li>
<li><strong>top</strong>
<ul>
<li>‘UNKNOWN’ is the most frequent borough recorded</li>
</ul></li>
<li><strong>freq</strong>
<ul>
<li>Tells us the occurrence of ‘UNKNOWN’ borough records</li>
</ul></li>
<li><strong>count</strong>
<ul>
<li>How many rows of data in the dataset</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Another check to see the unique borough names</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'BOROUGH'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['UNKNOWN', 'BROOKLYN', 'BRONX', 'MANHATTAN', 'QUEENS',
       'STATEN ISLAND'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="zip_code" class="level4">
<h4 class="anchored" data-anchor-id="zip_code">ZIP_CODE</h4>
<p>As with the BOROUGH column, the postal <strong>ZIP_CODE</strong> is often left empty. In this case, using <code>crash['ZIP_CODE'].describe()</code>, we see that the ZIP_CODE with the most collisions, <strong>top</strong>, is 11207 in Brooklyn. The <strong>freq</strong> gives a count of collisions for this zip code. It has a pretty large population, almost 80,000 people, which may account for the large numbers. A future project would be to see how these zip code counts relate to their population. The <strong>unique</strong> number tells us that there are 234 NYC zip codes with recorded collisions.</p>
<p><a href="https://www.unitedstateszipcodes.org/11207/">Check out zip code, 11207 here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'ZIP_CODE'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>count     1389547
unique        234
top         11207
freq        26853
Name: ZIP_CODE, dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace empty ZIP_CODE's with 'UNKNOWN'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>crash.fillna(value<span class="op">=</span>{<span class="st">'ZIP_CODE'</span>: <span class="st">'UNKNOWN'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'ZIP_CODE'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>COLLISION_ID
4455765    UNKNOWN
4513547    UNKNOWN
4541903    UNKNOWN
4456314      11208
4486609      11233
Name: ZIP_CODE, dtype: object</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up some date columns: YEAR, MONTH_NAME, DAY_NAME, HOUR</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and remove any records for 2012</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'YEAR'</span>] <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.year</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of 2012 as it only has 6 months of data</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>no_2012_mask <span class="op">=</span> crash[<span class="st">'YEAR'</span>] <span class="op">&gt;</span> <span class="dv">2012</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>crash <span class="op">=</span> crash[no_2012_mask]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the start_date variable to reflect the change</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.date.<span class="bu">min</span>()</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>year_order <span class="op">=</span> crash[<span class="st">'YEAR'</span>].sort_values().unique()</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Year order: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(year_order))</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a MONTH_NAME column. Actually, month abbreviated name</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'MONTH_NAME'</span>] <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.month_name().<span class="bu">str</span>[<span class="dv">0</span>:<span class="dv">3</span>]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Month abbreviations: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(crash.MONTH_NAME.unique()))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a HOUR column, which reflects the hour of day that the collision occurred</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'HOUR'</span>] <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.strftime(<span class="st">"%H"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to convert hour_order to a Python list instead of Numpy array</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>hour_order <span class="op">=</span> crash[<span class="st">'HOUR'</span>].sort_values().unique().tolist()</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Hour order: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(hour_order))</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'DAY_NAME'</span>] <span class="op">=</span> crash[<span class="st">'DATE'</span>].dt.strftime(<span class="st">"%a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Year order: [2013 2014 2015 2016 2017 2018 2019 2020 2021 2022 2023]
Month abbreviations: ['Sep' 'Mar' 'Jun' 'Dec' 'Apr' 'Jul' 'Feb' 'Aug' 'Nov' 'May' 'Jan' 'Oct']
Hour order: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23']</code></pre>
</div>
</div>
</section>
<section id="the-worst-years-for-collision-injuries-and-deaths" class="level4">
<h4 class="anchored" data-anchor-id="the-worst-years-for-collision-injuries-and-deaths">The Worst Years for Collision Injuries and Deaths</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the Yearly Killed/Injured counts</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>crash_by_year_killed <span class="op">=</span> crash.groupby(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'YEAR'</span>)[<span class="st">'NUM_PERSONS_KILLED'</span>].<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>crash_by_year_injured <span class="op">=</span> crash.groupby(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'YEAR'</span>)[<span class="st">'NUM_PERSONS_INJURED'</span>].<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5 Worst Years for Collision Deaths"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(crash_by_year_killed.head(<span class="dv">5</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">5 Worst Years for Collision Injuries"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(crash_by_year_injured.head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>5 Worst Years for Collision Deaths
YEAR
2013    297
2021    296
2022    287
2020    269
2014    262
Name: NUM_PERSONS_KILLED, dtype: int64

5 Worst Years for Collision Injuries
YEAR
2018    61941
2019    61389
2017    60656
2016    60317
2013    55124
Name: NUM_PERSONS_INJURED, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="chart-the-yearly-collisin-injuries-and-deaths" class="level4">
<h4 class="anchored" data-anchor-id="chart-the-yearly-collisin-injuries-and-deaths">Chart the Yearly Collisin Injuries and Deaths</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a plot using Matplotlib with Yearly details on the number of people killed and injured</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>killed_injured <span class="op">=</span> {</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Killed'</span>: crash_by_year_killed.loc[year_order], <span class="st">'Injured'</span>: crash_by_year_injured.loc[year_order]}</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(year_order))  <span class="co"># the label locations</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.45</span>  <span class="co"># the width of the bars</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>multiplier <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">15</span>), layout<span class="op">=</span><span class="st">'constrained'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the Injured/Killed bars for each year</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> killed_or_injured, count <span class="kw">in</span> killed_injured.items():</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> width <span class="op">*</span> multiplier</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    rects <span class="op">=</span> ax.bar(x <span class="op">+</span> offset, count, width, label<span class="op">=</span>killed_or_injured)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    ax.bar_label(rects, padding<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some text for labels, title and custom x-axis tick labels, etc.</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Year'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Killed/Injured Count'</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Persons Killed and Injured From </span><span class="sc">{0}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st">'</span>.<span class="bu">format</span>(</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    start_date, end_date), fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(x <span class="op">+</span> (width<span class="op">/</span><span class="dv">2</span>), year_order)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="test_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="collision-injuries-and-deaths-since-2013" class="level5">
<h5 class="anchored" data-anchor-id="collision-injuries-and-deaths-since-2013">Collision Injuries and Deaths since 2013</h5>
<p>The chart shows that traffic fatalities had a general downward trend froom the high or 297 in 2013 to a low of 231 in 2018. The trend is upwards from 2019 to 2021, which was just 1 off the worst year, 2013. For injuries, 2016 to 2019 were the worst. The following years are a slight improvement, but no visible downward trend yet.</p>
</section>
</section>
<section id="combine-killed-injured-counts-into-one-casualties-column" class="level4">
<h4 class="anchored" data-anchor-id="combine-killed-injured-counts-into-one-casualties-column">Combine Killed + Injured Counts into one ‘CASUALTIES’ column</h4>
<p>For each category, Person, Pedestrian, Cyclist and Motorist I’m going to combine the Killed/Injured counts into one ‘CASUALTY’ count.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the INJURED and KILLED columns into one 'CASUALTIES' column.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'PERSON_CASUALTY_COUNT'</span>] <span class="op">=</span> crash.NUM_PERSONS_INJURED <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    crash.NUM_PERSONS_KILLED</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'PEDESTRIAN_CASUALTY_COUNT'</span>] <span class="op">=</span> crash.NUM_PEDESTRIANS_INJURED <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    crash.NUM_PEDESTRIANS_KILLED</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'CYCLIST_CASUALTY_COUNT'</span>] <span class="op">=</span> crash.NUM_CYCLISTS_INJURED <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    crash.NUM_CYCLISTS_KILLED</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>crash[<span class="st">'MOTORIST_CASUALTY_COUNT'</span>] <span class="op">=</span> crash.NUM_MOTORISTS_INJURED <span class="op">+</span> <span class="op">\</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    crash.NUM_MOTORISTS_KILLED</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>crash.head(<span class="dv">60</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>kmm <span class="op">=</span> (crash.NUM_PERSONS_KILLED <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (crash.NUM_PERSONS_INJURED <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that it looks good</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>crash[kmm][[<span class="st">'NUM_PERSONS_KILLED'</span>, <span class="st">'NUM_PERSONS_INJURED'</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">'PERSON_CASUALTY_COUNT'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_PERSONS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_PERSONS_INJURED</th>
<th data-quarto-table-cell-role="th">PERSON_CASUALTY_COUNT</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">COLLISION_ID</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">4407693</td>
<td>1</td>
<td>4</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4457151</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4457192</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4457191</td>
<td>1</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4487497</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">Function to print count values above or to the side of chart bars</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">I got the original function from this useful site, https://www.statology.org</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">Original Fuction: https://www.statology.org/seaborn-barplot-show-values/</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> show_values(axs, orient<span class="op">=</span><span class="st">"v"</span>, space<span class="op">=</span><span class="fl">.01</span>):</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _single(ax):</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> orient <span class="op">==</span> <span class="st">"v"</span>:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                _x <span class="op">=</span> p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                _y <span class="op">=</span> p.get_y() <span class="op">+</span> p.get_height() <span class="op">+</span> (p.get_height()<span class="op">*</span><span class="fl">0.01</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                value <span class="op">=</span> <span class="st">'{:6,.0f}'</span>.<span class="bu">format</span>(p.get_height())</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                ax.text(_x, _y, value, ha<span class="op">=</span><span class="st">"center"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> orient <span class="op">==</span> <span class="st">"h"</span>:</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                _x <span class="op">=</span> p.get_x() <span class="op">+</span> p.get_width() <span class="op">+</span> <span class="bu">float</span>(space)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                _y <span class="op">=</span> p.get_y() <span class="op">+</span> p.get_height() <span class="op">-</span> (p.get_height()<span class="op">*</span><span class="fl">0.5</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                value <span class="op">=</span> <span class="st">'{:6,.0f}'</span>.<span class="bu">format</span>(p.get_width())</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                ax.text(_x, _y, value, ha<span class="op">=</span><span class="st">"left"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(axs, np.ndarray):</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, ax <span class="kw">in</span> np.ndenumerate(axs):</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>            _single(ax)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        _single(axs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">Helper functions for creating multiple charts based on Grouped statistics</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">Grouped time periods can be 'HOUR', 'MONTH', 'YEAR', 'DAY_NAME'</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">Statistics will be created for the below columns. </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">    PERSON_CASUALTY_COUNT</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">    PEDESTRIAN_CASUALTY_COUNT</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">    CYCLIST_CASUALTY_COUNT</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">    MOTORIST_CASUALTY_COUNT</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_grouped_casualty_data_by_category(victim_categories, time_group<span class="op">=</span><span class="st">"YEAR"</span>, order_list<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">    time_group can be 'HOUR', 'DAY_OF_WEEK', 'MONTH', 'YEAR' </span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    time_group <span class="op">=</span> time_group.upper()</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    all_casualty_data <span class="op">=</span> []</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> category <span class="kw">in</span> victim_categories:</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        cat_upper <span class="op">=</span> category.upper()</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        casualty_label <span class="op">=</span> cat_upper <span class="op">+</span> <span class="st">'_CASUALTY_COUNT'</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        casualty_data <span class="op">=</span> crash.groupby(</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>            by<span class="op">=</span>[time_group], as_index<span class="op">=</span><span class="va">True</span>).agg({casualty_label: <span class="st">'sum'</span>})</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> order_list <span class="kw">and</span> <span class="bu">len</span>(order_list):</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>            casualty_data <span class="op">=</span> casualty_data.loc[order_list]</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>        category_data <span class="op">=</span> {</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'category'</span>: category,</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'casualty_label'</span>: casualty_label,</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'casualty_data'</span>:  casualty_data</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        all_casualty_data.append(category_data)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_casualty_data</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_bar_plots_for_casualty_data(sns, axes, order_list, crash_victims_data):</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, category_data <span class="kw">in</span> <span class="bu">enumerate</span>(crash_victims_data):</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>        xlabel <span class="op">=</span> <span class="va">None</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>        ylabel <span class="op">=</span> <span class="va">None</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Casualty Chart</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>        category_title <span class="op">=</span> category_data[<span class="st">'category'</span>].title()</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>        chart_title <span class="op">=</span> <span class="st">"</span><span class="sc">{0}</span><span class="st"> Casualties"</span>.<span class="bu">format</span>(category_title)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>        casualty_max <span class="op">=</span> category_data[<span class="st">'casualty_data'</span>][category_data[<span class="st">'casualty_label'</span>]].<span class="bu">max</span>(</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>        casualty_values <span class="op">=</span> category_data[<span class="st">'casualty_data'</span>][category_data[<span class="st">'casualty_label'</span>]].to_list(</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>        casualty_colors <span class="op">=</span> [<span class="st">'tab:gray'</span> <span class="cf">if</span> (</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>            x <span class="op">&gt;=</span> casualty_max) <span class="cf">else</span> <span class="st">'tab:red'</span> <span class="cf">for</span> x <span class="kw">in</span> casualty_values]</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axes[idx]</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>        sns.barplot(data<span class="op">=</span>category_data[<span class="st">'casualty_data'</span>], x<span class="op">=</span>order_list, order<span class="op">=</span>order_list,</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>                    y<span class="op">=</span>category_data[<span class="st">'casualty_label'</span>], palette<span class="op">=</span>casualty_colors, ax<span class="op">=</span>ax).<span class="bu">set</span>(title<span class="op">=</span>chart_title, xlabel<span class="op">=</span>xlabel, ylabel<span class="op">=</span>ylabel)</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>        show_values(axes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">Set some global chart variables</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>title_fontsize <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>label_fontsize <span class="op">=</span> <span class="dv">18</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For spacing between charts on one grid</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>gridspec_kw <span class="op">=</span> {<span class="st">'wspace'</span>: <span class="fl">0.1</span>, <span class="st">'hspace'</span>: <span class="fl">0.1</span>}</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">''' Plot charts for crash casualties based on the Year'''</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>col_ct <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Create the outer figure box</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, col_ct, figsize<span class="op">=</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>, <span class="dv">40</span>), layout<span class="op">=</span><span class="st">"constrained"</span>, gridspec_kw<span class="op">=</span>gridspec_kw)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Total Yearly Crash Casualties from </span><span class="sc">{0}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st"> by Category"</span>.<span class="bu">format</span>(</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    start_date, end_date), fontsize<span class="op">=</span>title_fontsize)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">"Year"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">"Counts"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>crash_casualty_data <span class="op">=</span> create_grouped_casualty_data_by_category(</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    victim_categories, <span class="st">'year'</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>create_bar_plots_for_casualty_data(</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    sns, axes, year_order, crash_casualty_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="test_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">''' Plot charts for crash casualties based on the Month'''</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  Create the outer figure box</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>col_ct <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, col_ct, figsize<span class="op">=</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">20</span>, <span class="dv">30</span>), layout<span class="op">=</span><span class="st">"constrained"</span>, gridspec_kw<span class="op">=</span>gridspec_kw)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Total Monthly Crash Casualties from </span><span class="sc">{0}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st"> by Category"</span>.<span class="bu">format</span>(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    start_date, end_date), fontsize<span class="op">=</span>title_fontsize)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">"Month"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">"Counts"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>crash_casualty_data <span class="op">=</span> create_grouped_casualty_data_by_category(</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    victim_categories, <span class="st">'month_name'</span>, month_abbr_order)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>create_bar_plots_for_casualty_data(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    sns, axes, month_abbr_order, crash_casualty_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="test_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">Plot Charts for Day of Week Statistics</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>col_ct <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, col_ct, figsize<span class="op">=</span>(</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>, <span class="dv">40</span>), layout<span class="op">=</span><span class="st">"constrained"</span>, gridspec_kw<span class="op">=</span>gridspec_kw)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Total Day of Week Crash Casualties from </span><span class="sc">{0}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st"> by Category"</span>.<span class="bu">format</span>(</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    start_date, end_date), fontsize<span class="op">=</span>title_fontsize)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">"Day of Week"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">"Counts"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># crash.set_index('MONTH_NAME').loc[month_abbr_order].groupby(by=['MONTH_NAME']).agg({'PEDESTRIAN_CASUALTY_COUNT': 'sum'}).plot(kind='bar')</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>crash_casualty_data <span class="op">=</span> create_grouped_casualty_data_by_category(</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    victim_categories, <span class="st">'day_name'</span>, day_abbr_order)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>crash_casualty_data</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>create_bar_plots_for_casualty_data(</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    sns, axes, day_abbr_order, crash_casualty_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="test_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">''' Plot charts for crash casualties based on the Hour of Day'''</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  Create the outer figure box</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>col_ct <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">4</span>, col_ct, figsize<span class="op">=</span>(</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">15</span>, <span class="dv">40</span>), layout<span class="op">=</span><span class="st">"constrained"</span>, gridspec_kw<span class="op">=</span>gridspec_kw)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Total Hour of Day Crash Casualties from </span><span class="sc">{0}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st"> by Category"</span>.<span class="bu">format</span>(</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    start_date, end_date), fontsize<span class="op">=</span>title_fontsize)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">"Hour of Day"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">"Counts"</span>, fontsize<span class="op">=</span>label_fontsize)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>crash_casualty_data <span class="op">=</span> create_grouped_casualty_data_by_category(</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    victim_categories, <span class="st">'hour'</span>, hour_order)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="co">#  Create the inner charts</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>create_bar_plots_for_casualty_data(</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    sns, axes, hour_order, crash_casualty_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="test_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>crash.groupby(by<span class="op">=</span>[<span class="st">'YEAR'</span>]).agg({<span class="st">'NUM_CYCLISTS_KILLED'</span>: <span class="st">'sum'</span>, <span class="st">'NUM_CYCLISTS_INJURED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_CYCLISTS_KILLED'</span>, <span class="st">'NUM_CYCLISTS_INJURED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_CYCLISTS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_CYCLISTS_INJURED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">YEAR</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2019</td>
<td>31</td>
<td>4986</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020</td>
<td>29</td>
<td>5576</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2017</td>
<td>27</td>
<td>4889</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023</td>
<td>21</td>
<td>2977</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014</td>
<td>20</td>
<td>4000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022</td>
<td>19</td>
<td>5026</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021</td>
<td>19</td>
<td>4961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>18</td>
<td>4975</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2015</td>
<td>15</td>
<td>4281</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2013</td>
<td>11</td>
<td>4075</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>10</td>
<td>4725</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hide</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>crash.groupby(by<span class="op">=</span>[<span class="st">'YEAR'</span>]).agg({<span class="st">'NUM_PEDESTRIANS_KILLED'</span>: <span class="st">'sum'</span>, <span class="st">'NUM_PEDESTRIANS_INJURED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_PEDESTRIANS_INJURED'</span>, <span class="st">'NUM_PEDESTRIANS_KILLED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># by=['NUM_PEDESTRIANS_KILLED', 'NUM_PEDESTRIANS_INJURED'], ascending=False)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_KILLED</th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_INJURED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">YEAR</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2013</td>
<td>176</td>
<td>11988</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2017</td>
<td>127</td>
<td>11151</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2018</td>
<td>123</td>
<td>11123</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2016</td>
<td>149</td>
<td>11090</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2014</td>
<td>133</td>
<td>11036</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2019</td>
<td>131</td>
<td>10568</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2015</td>
<td>133</td>
<td>10084</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2022</td>
<td>132</td>
<td>8975</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2021</td>
<td>131</td>
<td>7501</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2020</td>
<td>101</td>
<td>6691</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023</td>
<td>53</td>
<td>5199</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>killed_ped_month_group <span class="op">=</span> crash.groupby(by<span class="op">=</span>[<span class="st">'MONTH_NAME'</span>]).agg({<span class="st">'NUM_PEDESTRIANS_KILLED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_PEDESTRIANS_KILLED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>killed_ped_month_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_KILLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MONTH_NAME</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Nov</td>
<td>151</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Oct</td>
<td>138</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dec</td>
<td>136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jan</td>
<td>123</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sep</td>
<td>117</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>injured_ped_month_group <span class="op">=</span> crash.groupby(by<span class="op">=</span>[<span class="st">'MONTH_NAME'</span>]).agg({<span class="st">'NUM_PEDESTRIANS_INJURED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_PEDESTRIANS_INJURED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>injured_ped_month_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_PEDESTRIANS_INJURED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MONTH_NAME</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Dec</td>
<td>10614</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jan</td>
<td>10133</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Nov</td>
<td>9576</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Oct</td>
<td>9553</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Mar</td>
<td>9079</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>killed_cyc_month_group <span class="op">=</span> crash.groupby(by<span class="op">=</span>[<span class="st">'MONTH_NAME'</span>]).agg({<span class="st">'NUM_CYCLISTS_KILLED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_CYCLISTS_KILLED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>killed_cyc_month_group.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NUM_CYCLISTS_KILLED</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">MONTH_NAME</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Jun</td>
<td>36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jul</td>
<td>26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Sep</td>
<td>25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Aug</td>
<td>20</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">May</td>
<td>20</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>killed_mot_month_group <span class="op">=</span> crash.groupby(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MONTH_NAME'</span>)[<span class="st">'NUM_MOTORISTS_KILLED'</span>].<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>killed_mot_month_group.head(<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MONTH_NAME
Jul    131
Jun    126
Aug    124
May    108
Sep    104
Apr     93
Nov     86
Oct     81
Jan     73
Dec     72
Feb     67
Mar     66
Name: NUM_MOTORISTS_KILLED, dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>innjured_mot_month_group <span class="op">=</span> crash.groupby(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MONTH_NAME'</span>)[<span class="st">'NUM_MOTORISTS_INJURED'</span>].<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>innjured_mot_month_group.head(<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MONTH_NAME
Jul    41009
Jun    40883
May    39722
Aug    38051
Sep    35934
Oct    35172
Apr    33746
Mar    33482
Nov    32447
Dec    31690
Jan    30270
Feb    27842
Name: NUM_MOTORISTS_INJURED, dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>killed_injured_by_zip <span class="op">=</span> crash.groupby(by<span class="op">=</span>[<span class="st">'ZIP_CODE'</span>]).agg({<span class="st">'NUM_PERSONS_KILLED'</span>: <span class="st">'sum'</span>, <span class="st">'NUM_PERSONS_INJURED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_PERSONS_KILLED'</span>, <span class="st">'NUM_PERSONS_INJURED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>injured_killed_by_zip <span class="op">=</span> crash.groupby(by<span class="op">=</span>[<span class="st">'ZIP_CODE'</span>]).agg({<span class="st">'NUM_PERSONS_KILLED'</span>: <span class="st">'sum'</span>, <span class="st">'NUM_PERSONS_INJURED'</span>: <span class="st">'sum'</span>}).sort_values(</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'NUM_PERSONS_INJURED'</span>, <span class="st">'NUM_PERSONS_KILLED'</span>], ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"     5 Worst zip codes for crash deaths."</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(killed_injured_by_zip.head(<span class="dv">5</span>))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"     5 Worst zip codes for crash injuries."</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(injured_killed_by_zip.head(<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     5 Worst zip codes for crash deaths.
          NUM_PERSONS_KILLED  NUM_PERSONS_INJURED
ZIP_CODE                                         
UNKNOWN                 1145               205507
11236                     45                 7482
11207                     32                 9956
11234                     28                 5460
11208                     25                 6044
     5 Worst zip codes for crash injuries.
          NUM_PERSONS_KILLED  NUM_PERSONS_INJURED
ZIP_CODE                                         
UNKNOWN                 1145               205507
11207                     32                 9956
11236                     45                 7482
11203                     13                 7367
11212                     17                 6631</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>